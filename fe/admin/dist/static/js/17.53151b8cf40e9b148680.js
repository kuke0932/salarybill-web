webpackJsonp([17],{"3X1c":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("woOf"),a=t.n(r),i=t("vLgD"),s=t("mw3O"),o=t.n(s);var l=t("5ybE"),d=t("YY3n"),m={name:"user",data:function(){return{total:-1,pageNum:1,pageSize:10,userId:null,userList:null,searchLoginName:"",searchUserName:"",departmentId:null,multipleSelection:[],editDisabled:!1,listLoading:!1,departmentTree:null,dialogVisible:!1,editDialogVisible:!1,resetPasswordVisible:!1,addForm:{loginName:"",loginPwd:"",department:"",userName:"",mobile:"",telephone:"",email:""},editForm:{department:"",userName:"",mobile:"",telephone:"",email:""},resetPasswordForm:{loginPwd:null},resetRules:{loginPwd:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"请输入6位以上密码",trigger:"blur"}]},rules:{loginName:[{required:!0,message:"请输入登录名",trigger:"blur"},{min:3,max:10,message:"长度在3到10个字符之间",trigger:"blur"}],loginPwd:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:10,message:"长度在6到12个字符之间",trigger:"blur"}],department:[{required:!0,message:"请选择部门"}],userName:[{required:!0,message:"请输入用户昵称",trigger:"blur"},{min:3,max:10,message:"长度在3到12个字符之间",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/(13\d|14[579]|15[^4\D]|17[^49\D]|18\d)\d{8}/,message:"手机号格式错误",trigger:"blur"}],telephone:[{pattern:/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/,message:"座机号格式错误",trigger:"blur"}],email:[{required:!0,message:"请输入电子邮箱",trigger:"blur"},{pattern:/^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$/,message:"邮箱格式错误",trigger:"blur"}]},defaultProps:{children:"children",label:"label"}}},updated:function(){Object(d.a)(location.hash.substring(2))},mounted:function(){Object(d.a)(location.hash.substring(2)),this.initDepartmentTree(),this.fetchData(null,"","",1,this.pageNum,this.pageSize)},methods:{handleNodeClick:function(e){this.departmentId=e.id,e.parentId||(this.departmentId=null),this.fetchData(this.departmentId,"","",1,this.pageNum,this.pageSize)},initDepartmentTree:function(){var e=this;Object(l.e)().then(function(n){e.departmentTree=n.data.data})},fetchData:function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=this,s=arguments[4],o=arguments[5];this.listLoading=!0,function(e,n,t){var r={departmentId:e,loginName:n,userName:t,showOrAdd:arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,pageNum:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,pageSize:arguments.length>5&&void 0!==arguments[5]?arguments[5]:10};return Object(i.a)({url:"/system/admin/sysUser/listUser",method:"get",params:r})}(e,n,t,r,s,o).then(function(e){a.userList=e.data.data.rows,a.userList.forEach(function(e,n){e.idx=n}),a.total=e.data.data.total,a.pageNum=e.data.data.pageNum,a.pageSize=e.data.data.pageSize,a.listLoading=!1})},search:function(){this.fetchData(this.departmentId,this.searchLoginName,this.searchUserName,1,this.pageNum,this.pageSize)},checkStatus:function(e,n,t){var r=this;(function(e,n){var t={id:e,status:n};return Object(i.a)({url:"/system/admin/sysUser/updateStatus",method:"post",data:o.a.stringify(t)})})(n,t=1===t?0:1).then(function(){r.$message({type:"success",message:"操作成功!",duration:1e3,onClose:function(){r.userList[e].status=t}})})},handleCurrentPageChange:function(e){this.listLoading=!0,this.pageNum=e,this.fetchData(this.departmentId,this.searchLoginName,this.searchUserName,1,this.pageNum,this.pageSize)},edit:function(e){this.userId=e,this.resetPasswordVisible=!0},resetSubmit:function(e){var n=this;this.$refs[e].validate(function(t){var r,a,s;t&&(r=n.userId,a=n.resetPasswordForm.loginPwd,s={id:r,loginPwd:a},Object(i.a)({url:"/system/admin/sysUser/resetPassword",method:"post",data:o.a.stringify(s)})).then(function(){n.$message({type:"success",message:"重置成功",duration:2e3,onClose:function(){n.resetPasswordVisible=!1,n.$refs[e].resetFields()}})})})},goAddUser:function(){this.dialogVisible=!0},handleSelectionChange:function(e){var n=this;this.multipleSelection=e,e.length>0?e.forEach(function(e){1===e.id?n.editDisabled=!0:n.editDisabled=!1}):this.editDisabled=!1},goEditUser:function(){var e,n=this;1===this.multipleSelection.length?((e=this.multipleSelection[0].id,Object(i.a)({url:"/system/admin/sysUser/getUserById",method:"get",params:{id:e}})).then(function(e){var t=e.data.data,r="";n.$refs.treeEdit.setCheckedKeys(t.departmentIdList),n.$refs.treeEdit.getCheckedNodes()&&n.$refs.treeEdit.getCheckedNodes().forEach(function(e){r+="，"+e.label}),n.editForm.id=t.id,n.editForm.loginName=t.loginName,n.editForm.department=r.substr(1),n.editForm.userName=t.userName,n.editForm.mobile=t.mobile,n.editForm.telephone=t.telephone,n.editForm.email=t.email}),this.editDialogVisible=!0):this.$message({type:"warning",message:"请选中一行再执行此操作!"})},deleteUser:function(){var e=this;0!==this.multipleSelection.length?this.$confirm("此操作将永久删除该用户，是否继续","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var n=e.multipleSelection,t=[],r=0;r<n.length;r++)t.push(n[r].id);(function(e){return Object(i.a)({url:"/system/admin/sysUser/removeUser",method:"post",data:o.a.stringify({ids:e})})})(t.join(",")).then(function(n){e.$message({type:"success",message:"删除成功",duration:2e3,onClose:function(){e.fetchData(e.departmentId,"","",1,e.pageNum,e.pageSize)}})})}):this.$message({type:"warning",message:"请至少选中一行再执行此操作!",duration:2e3})},submitForm:function(e){var n=this;this.$refs[e].validate(function(t){if(!t)return console.log("error submit!!"),!1;var r="";if("addForm"===e)n.$refs.treeAdd.getCheckedNodes().forEach(function(e){r+=","+e.id}),function(e,n,t,r,a,s,l){var d={loginName:e,loginPwd:n,departmentIds:t,userName:r,mobile:a,telephone:s,email:l};return Object(i.a)({url:"/system/admin/sysUser/addUser",method:"post",data:o.a.stringify(d)})}(n.addForm.loginName,n.addForm.loginPwd,r.substr(1),n.addForm.userName,n.addForm.mobile,n.addForm.telephone,n.addForm.email).then(function(){n.$message({type:"success",message:"添加成功!",duration:1500,onClose:function(){n.fetchData(n.departmentId,"","",1,n.pageNum,n.pageSize),n.$refs[e].resetFields(),n.dialogVisible=!1}})});else if("editForm"===e){n.$refs.treeEdit.getCheckedNodes().forEach(function(e){r+=","+e.id}),function(e,n,t,r,a,s){var l={id:e,departmentIds:n,userName:t,mobile:r,telephone:a,email:s};return Object(i.a)({url:"/system/admin/sysUser/updateUser",method:"post",data:o.a.stringify(l)})}(n.editForm.id,r.substr(1),n.editForm.userName,n.editForm.mobile,n.editForm.telephone,n.editForm.email).then(function(){n.$message({type:"success",message:"修改成功!",duration:1500,onClose:function(){var t=a()(n.userList[n.multipleSelection[0].idx],{departmentIdList:r,departmentNameList:n.editForm.department},n.editForm);n.editDialogVisible=!1,n.$set(n.userList,n.multipleSelection[0].idx,t),n.$refs[e].resetFields(),n.editDialogVisible=!1}})})}})},resetForm:function(e){this.$refs[e].resetFields()},handleClose:function(e){var n=this;this.$confirm("确认关闭吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e(),n.$refs.addForm.resetFields(),n.$refs.editForm.resetFields(),n.$refs.resetPasswordForm.resetFields()}).catch(function(){})},currentDepartmentEdit:function(){var e="";this.$refs.treeEdit.getCheckedNodes().forEach(function(n){e+="，"+n.label}),this.editForm.department=e.substr(1)},currentDepartmentAdd:function(){var e="";this.$refs.treeAdd.getCheckedNodes().forEach(function(n){e+="，"+n.label}),this.addForm.department=e.substr(1)}}},c={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"container"},[t("el-row",[t("el-col",{attrs:{span:4}},[t("h4",{staticStyle:{"margin-top":"0",color:"#606266"}},[e._v("部门列表")]),e._v(" "),t("el-tree",{ref:"tree",attrs:{data:e.departmentTree,"node-key":"id","highlight-current":"","default-expand-all":"","expand-on-click-node":!1,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1),e._v(" "),t("el-col",{attrs:{span:18}},[t("el-form",[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{"label-width":"70px",label:"登录名"}},[t("el-input",{staticStyle:{"min-width":"120px"},model:{value:e.searchLoginName,callback:function(n){e.searchLoginName=n},expression:"searchLoginName"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{"label-width":"80px",label:"用户昵称"}},[t("el-input",{staticStyle:{"min-width":"120px"},model:{value:e.searchUserName,callback:function(n){e.searchUserName=n},expression:"searchUserName"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:3}},[t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",loading:e.listLoading},on:{click:e.search}},[e._v("查询")])],1)],1),e._v(" "),t("div",{staticClass:"btn_box"},[t("el-button",{staticClass:"el-button--primary hidden",attrs:{code:"add"},on:{click:e.goAddUser}},[e._v("添加用户")]),e._v(" "),t("el-button",{staticClass:"el-button--primary hidden",attrs:{disabled:e.editDisabled,code:"edit"},on:{click:e.goEditUser}},[e._v("修改用户")]),e._v(" "),t("el-button",{staticClass:"el-button--danger hidden",attrs:{disabled:e.editDisabled,code:"del"},on:{click:e.deleteUser}},[e._v("删除用户")])],1),e._v(" "),t("el-dialog",{attrs:{title:"添加用户",visible:e.dialogVisible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(n){e.dialogVisible=n}}},[t("el-popover",{ref:"popoverTree",attrs:{placement:"bottom-start",title:"部门列表",width:"400",trigger:"click"}},[t("el-tree",{ref:"treeAdd",attrs:{data:e.departmentTree,"show-checkbox":"","node-key":"id","highlight-current":"",props:e.defaultProps,"expand-on-click-node":!1,"check-strictly":!0},on:{"check-change":e.currentDepartmentAdd}})],1),e._v(" "),t("el-form",{ref:"addForm",attrs:{rules:e.rules,model:e.addForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"登录名",prop:"loginName"}},[t("el-input",{model:{value:e.addForm.loginName,callback:function(n){e.$set(e.addForm,"loginName",n)},expression:"addForm.loginName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"loginPwd"}},[t("el-input",{attrs:{type:"password"},model:{value:e.addForm.loginPwd,callback:function(n){e.$set(e.addForm,"loginPwd",n)},expression:"addForm.loginPwd"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"部门",prop:"department"}},[t("el-input",{directives:[{name:"popover",rawName:"v-popover:popoverTree",arg:"popoverTree"}],attrs:{readonly:""},model:{value:e.addForm.department,callback:function(n){e.$set(e.addForm,"department",n)},expression:"addForm.department"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"用户昵称",prop:"userName"}},[t("el-input",{model:{value:e.addForm.userName,callback:function(n){e.$set(e.addForm,"userName",n)},expression:"addForm.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[t("el-input",{model:{value:e.addForm.mobile,callback:function(n){e.$set(e.addForm,"mobile",n)},expression:"addForm.mobile"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"座机号",prop:"telephone"}},[t("el-input",{model:{value:e.addForm.telephone,callback:function(n){e.$set(e.addForm,"telephone",n)},expression:"addForm.telephone"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[t("el-input",{model:{value:e.addForm.email,callback:function(n){e.$set(e.addForm,"email",n)},expression:"addForm.email"}})],1),e._v(" "),t("el-form-item",{staticClass:"btn_box"},[t("el-button",{attrs:{type:"primary"},on:{click:function(n){e.submitForm("addForm")}}},[e._v("提交")]),e._v(" "),t("el-button",{on:{click:function(n){e.resetForm("addForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"修改用户",visible:e.editDialogVisible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(n){e.editDialogVisible=n}}},[t("el-popover",{ref:"popoverTree",attrs:{placement:"bottom-start",title:"部门列表",width:"400",trigger:"click"}},[t("el-tree",{ref:"treeEdit",attrs:{data:e.departmentTree,"show-checkbox":"","node-key":"id","highlight-current":"",props:e.defaultProps,"expand-on-click-node":!1,"check-strictly":!0},on:{"check-change":e.currentDepartmentEdit}})],1),e._v(" "),t("el-form",{ref:"editForm",attrs:{rules:e.rules,model:e.editForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"登录名"}},[t("el-input",{attrs:{readonly:""},model:{value:e.editForm.loginName,callback:function(n){e.$set(e.editForm,"loginName",n)},expression:"editForm.loginName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"部门",prop:"department"}},[t("el-input",{directives:[{name:"popover",rawName:"v-popover:popoverTree",arg:"popoverTree"}],attrs:{readonly:""},model:{value:e.editForm.department,callback:function(n){e.$set(e.editForm,"department",n)},expression:"editForm.department"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"用户昵称",prop:"userName"}},[t("el-input",{model:{value:e.editForm.userName,callback:function(n){e.$set(e.editForm,"userName",n)},expression:"editForm.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[t("el-input",{model:{value:e.editForm.mobile,callback:function(n){e.$set(e.editForm,"mobile",n)},expression:"editForm.mobile"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"座机号",prop:"telephone"}},[t("el-input",{model:{value:e.editForm.telephone,callback:function(n){e.$set(e.editForm,"telephone",n)},expression:"editForm.telephone"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[t("el-input",{model:{value:e.editForm.email,callback:function(n){e.$set(e.editForm,"email",n)},expression:"editForm.email"}})],1),e._v(" "),t("el-form-item",{staticClass:"btn_box"},[t("el-button",{attrs:{type:"primary"},on:{click:function(n){e.submitForm("editForm")}}},[e._v("提交")]),e._v(" "),t("el-button",{on:{click:function(n){e.resetForm("editForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.userList,"element-loading-text":"拼命加载中",border:"",fit:"","tooltip-effect":"dark","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),t("el-table-column",{attrs:{label:"登录名"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n            "+e._s(n.row.loginName)+"\n          ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"部门"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n            "+e._s(n.row.departmentName)+"\n          ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"用户昵称"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n            "+e._s(n.row.userName)+"\n          ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"手机号"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n            "+e._s(n.row.mobile)+"\n          ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n            "+e._s(1==n.row.status?"正常":"冻结")+"\n          ")]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(n){return[t("el-button",{staticClass:"hidden",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",code:"on_off",size:"small"},on:{click:function(t){e.checkStatus(n.$index,n.row.id,n.row.status)}}},[e._v("\n              "+e._s(1==n.row.status?"禁用":"启用")+"\n            ")]),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small",disabled:e.editDisabled},on:{click:function(t){e.edit(n.row.id)}}},[e._v("重置密码")])]}}])})],1),e._v(" "),t("el-dialog",{attrs:{title:"重置密码",visible:e.resetPasswordVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(n){e.resetPasswordVisible=n}}},[t("el-form",{ref:"resetPasswordForm",attrs:{rules:e.resetRules,model:e.resetPasswordForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"密码",prop:"loginPwd"}},[t("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"请输入6位以上密码"},model:{value:e.resetPasswordForm.loginPwd,callback:function(n){e.$set(e.resetPasswordForm,"loginPwd",n)},expression:"resetPasswordForm.loginPwd"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(n){e.resetSubmit("resetPasswordForm")}}},[e._v("提交")])],1)],1)],1),e._v(" "),t("el-pagination",{staticStyle:{float:"right","margin-top":"15px"},attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize},on:{"current-change":e.handleCurrentPageChange}})],1)],1)],1)],1)},staticRenderFns:[]};var u=t("VU/8")(m,c,!1,function(e){t("wI3W")},"data-v-56664250",null);n.default=u.exports},SSXO:function(e,n,t){(e.exports=t("FZ+f")(!1)).push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},wI3W:function(e,n,t){var r=t("SSXO");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("rjj0")("65dfa81e",r,!0)}});