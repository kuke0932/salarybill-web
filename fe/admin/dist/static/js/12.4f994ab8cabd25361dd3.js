webpackJsonp([12],{"/DqB":function(e,n,t){(e.exports=t("FZ+f")(!1)).push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},SJ7l:function(e,n,t){var a=t("/DqB");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);t("rjj0")("9a3e5074",a,!0)},W10w:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t("YY3n"),r=t("5ybE"),i={name:"department",data:function(){return{total:-1,pageNum:1,pageSize:10,parentId:null,departmentTree:null,departmentList:null,searchDepartmentName:null,listLoading:!1,dialogVisible:!1,editDialogVisible:!1,editDisabled:!1,addForm:{departmentName:"",parentName:"",parentId:null,departmentDesc:""},editForm:{departmentName:"",parentName:"",parentId:null,departmentDesc:""},rules:{departmentName:[{required:!0,message:"请输入部门名",trigger:"blur"}],parentName:[{required:!0,message:"请选择父部门",trigger:"change"}],departmentDesc:[{required:!0,message:"请输入部门描述",trigger:"blur"}]},defaultProps:{children:"children",label:"label"}}},mounted:function(){Object(a.a)(location.hash.substring(2)),this.initDepartmentTree(),this.fetchData(null,null,this.pageNum,this.pageSize)},methods:{initDepartmentTree:function(){var e=this;Object(r.e)().then(function(n){e.departmentTree=n.data.data})},fetchData:function(e,n,t,a){var i=this;this.listLoading=!0,Object(r.c)(e,n,t,a).then(function(e){i.departmentList=e.data.data.rows,i.total=e.data.data.total,i.pageNum=e.data.data.pageNum,i.pageSize=e.data.data.pageSize,i.listLoading=!1})},currentNodeClick:function(e,n){this.parentId=e.id,this.fetchData(e.id,null,this.pageNum,this.pageSize),1===e.id?this.editDisabled=!0:this.editDisabled=!1},search:function(){this.fetchData(this.parentId,this.searchDepartmentName,this.pageNum,this.pageSize)},goAddDepartment:function(){this.dialogVisible=!0},goEditDepartment:function(){var e=this;this.parentId?(Object(r.b)(this.parentId).then(function(n){e.editForm.departmentName=n.data.data.departmentName,e.editForm.parentName=n.data.data.parentName,e.editForm.departmentDesc=n.data.data.departmentDesc}),this.editDialogVisible=!0):this.$message({type:"warning",message:"请在左侧部门列表中选一行再执行此操作!"})},iteratorTree:function(e,n){var t=this;e.forEach(function(a){if(a.id===n){var r=e.indexOf(a);e.splice(r,1)}else{if(!a.children)return;t.iteratorTree(a.children,n)}})},deleteDepartment:function(){var e=this;this.parentId?this.$confirm("此操作将永久删除该部门，并且与该部门有关的所有权限也将一并删除，是否继续","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.d)(e.parentId).then(function(n){e.$message({type:"success",message:"删除成功",duration:2e3,onClose:function(){var n=e.$refs.tree.getCurrentNode().id;e.iteratorTree(e.departmentTree,n)}})})}):this.$message({type:"warning",message:"请在左侧部门列表中选一行再执行此操作!",duration:"2000"})},submitForm:function(e){var n=this;this.$refs[e].validate(function(t){if(!t)return console.log("error submit!!"),!1;"addForm"===e?Object(r.a)(n.addForm.departmentName,n.addForm.parentId,n.addForm.departmentDesc).then(function(){n.$message({type:"success",message:"添加成功!",duration:1500,onClose:function(){n.initDepartmentTree(),n.fetchData(null,null,n.pageNum,n.pageSize),n.$refs[e].resetFields(),n.dialogVisible=!1}})}):"editForm"===e&&Object(r.f)(n.parentId,n.editForm.departmentName,n.editForm.parentId,n.editForm.departmentDesc).then(function(){n.$message({type:"success",message:"修改成功!",duration:1500,onClose:function(){n.initDepartmentTree(),n.fetchData(null,null,n.pageNum,n.pageSize),n.$refs[e].resetFields(),n.editDialogVisible=!1}})})})},resetForm:function(e){this.$refs[e].resetFields()},handleClose:function(e){var n=this;this.$confirm("确认关闭吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e(),n.$refs.addForm.resetFields(),n.$refs.editForm.resetFields()}).catch(function(){})},handleCurrentPageChange:function(e){this.pageNum=e,this.fetchData(this.parentId,this.searchDepartmentName,this.pageNum,this.pageSize)},currentDepartmentEdit:function(){var e=this.$refs.treeEdit.getCurrentNode();this.editForm.parentName=e.label,this.editForm.parentId=e.id},currentDepartmentAdd:function(){var e=this.$refs.treeAdd.getCurrentNode();this.addForm.parentName=e.label,this.addForm.parentId=e.id}}},o={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"container"},[t("el-row",[t("el-col",{attrs:{span:4}},[t("h4",{staticStyle:{"margin-top":"0",color:"#606266"}},[e._v("部门列表")]),e._v(" "),t("el-tree",{ref:"tree",attrs:{data:e.departmentTree,"node-key":"id","highlight-current":"","default-expand-all":"",props:e.defaultProps,"expand-on-click-node":!1},on:{"node-click":e.currentNodeClick}})],1),e._v(" "),t("el-col",{attrs:{span:18}},[t("el-form",[t("el-row",[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{"label-width":"70px",label:"部门名称"}},[t("el-input",{staticStyle:{"min-width":"120px"},model:{value:e.searchDepartmentName,callback:function(n){e.searchDepartmentName=n},expression:"searchDepartmentName"}})],1)],1),e._v(" "),t("el-col",{attrs:{span:3}},[t("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",loading:e.listLoading},on:{click:e.search}},[e._v("查询")])],1)],1),e._v(" "),t("div",{staticClass:"btn_box"},[t("el-button",{staticClass:"el-button--primary hidden",attrs:{code:"add"},on:{click:e.goAddDepartment}},[e._v("添加部门")]),e._v(" "),t("el-button",{staticClass:"el-button--primary hidden",attrs:{code:"edit",disabled:e.editDisabled},on:{click:e.goEditDepartment}},[e._v("修改部门")]),e._v(" "),t("el-button",{staticClass:"el-button--danger hidden",attrs:{code:"del",disabled:e.editDisabled},on:{click:e.deleteDepartment}},[e._v("删除部门")])],1),e._v(" "),t("el-dialog",{attrs:{title:"添加部门",visible:e.dialogVisible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(n){e.dialogVisible=n}}},[t("el-popover",{ref:"popoverTree",attrs:{placement:"bottom-start",title:"部门列表",width:"400",trigger:"click"}},[t("el-tree",{ref:"treeAdd",attrs:{data:e.departmentTree,"node-key":"id","highlight-current":"",props:e.defaultProps,"expand-on-click-node":!1,"check-strictly":!0},on:{"node-click":e.currentDepartmentAdd}})],1),e._v(" "),t("el-form",{ref:"addForm",attrs:{rules:e.rules,model:e.addForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"部门名",prop:"departmentName"}},[t("el-input",{model:{value:e.addForm.departmentName,callback:function(n){e.$set(e.addForm,"departmentName",n)},expression:"addForm.departmentName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"父部门",prop:"parentName"}},[t("el-input",{directives:[{name:"popover",rawName:"v-popover:popoverTree",arg:"popoverTree"}],attrs:{readonly:""},model:{value:e.addForm.parentName,callback:function(n){e.$set(e.addForm,"parentName",n)},expression:"addForm.parentName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"部门描述",prop:"departmentDesc"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.addForm.departmentDesc,callback:function(n){e.$set(e.addForm,"departmentDesc",n)},expression:"addForm.departmentDesc"}})],1),e._v(" "),t("el-form-item",{staticClass:"btn_box"},[t("el-button",{attrs:{type:"primary"},on:{click:function(n){e.submitForm("addForm")}}},[e._v("提交")]),e._v(" "),t("el-button",{on:{click:function(n){e.resetForm("addForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),t("el-dialog",{attrs:{title:"修改部门",visible:e.editDialogVisible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(n){e.editDialogVisible=n}}},[t("el-popover",{ref:"popoverTree",attrs:{placement:"bottom-start",title:"部门列表",width:"400",trigger:"click"}},[t("el-tree",{ref:"treeEdit",attrs:{data:e.departmentTree,"node-key":"id","highlight-current":"",props:e.defaultProps,"expand-on-click-node":!1,"check-strictly":!0},on:{"node-click":e.currentDepartmentEdit}})],1),e._v(" "),t("el-form",{ref:"editForm",attrs:{rules:e.rules,model:e.editForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"部门名",prop:"departmentName"}},[t("el-input",{model:{value:e.editForm.departmentName,callback:function(n){e.$set(e.editForm,"departmentName",n)},expression:"editForm.departmentName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"父部门",prop:"parentName"}},[t("el-input",{directives:[{name:"popover",rawName:"v-popover:popoverTree",arg:"popoverTree"}],attrs:{readonly:""},model:{value:e.editForm.parentName,callback:function(n){e.$set(e.editForm,"parentName",n)},expression:"editForm.parentName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"部门描述",prop:"departmentDesc"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.editForm.departmentDesc,callback:function(n){e.$set(e.editForm,"departmentDesc",n)},expression:"editForm.departmentDesc"}})],1),e._v(" "),t("el-form-item",{staticClass:"btn_box"},[t("el-button",{attrs:{type:"primary"},on:{click:function(n){e.submitForm("editForm")}}},[e._v("提交")]),e._v(" "),t("el-button",{on:{click:function(n){e.resetForm("editForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.departmentList,"element-loading-text":"拼命加载中",border:"",fit:"","tooltip-effect":"dark","highlight-current-row":""}},[t("el-table-column",{attrs:{label:"部门名",width:"250"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n                "+e._s(n.row.departmentName)+"\n              ")]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"departmentDesc",label:"部门描述"},scopedSlots:e._u([{key:"default",fn:function(n){return[e._v("\n                "+e._s(n.row.departmentDesc)+"\n              ")]}}])})],1),e._v(" "),t("el-pagination",{staticStyle:{float:"right","margin-top":"15px"},attrs:{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize},on:{"current-change":e.handleCurrentPageChange}})],1)],1)],1)],1)},staticRenderFns:[]};var d=t("VU/8")(i,o,!1,function(e){t("SJ7l")},"data-v-a7070fea",null);n.default=d.exports}});