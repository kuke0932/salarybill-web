webpackJsonp([11],{"3Kwo":function(n,t,e){var a=e("VWJD");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("rjj0")("60c57557",a,!0)},VWJD:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},bI5R:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("YY3n"),l=e("vLgD"),i=e("mw3O"),s=e.n(i);function r(n,t,e,a){var i={salarybillIds:n,salaryDates:t,enterpriseIds:e,"x-auth-token":a};return Object(l.a)({url:"/salarybill/admin/salarybill/sendWebChatMessage",method:"post",data:s.a.stringify(i)})}var o=e("TIfe"),u={name:"salary",components:{},data:function(){return{total:-1,pageNum:1,pageSize:50,dataList:[{}],options:[{value:"0",label:"已保存"},{value:"1",label:"待确认"},{value:"2",label:"待打款"},{value:"3",label:"已打款"}],status:"",multipleSelection:[],secrchDate:"2018-04",searchStatus:null,searchName:null,listLoading:!1,leadinDialog:!1,sheetname:null,fileList:[],token:{"x-auth-token":Object(o.a)()},ids:"",remitDialog:!1,imgDialog:!1,remitMoney:null,dialogImageUrl:"",salarybillId:0,currentIndex:-1}},computed:{getTransformData:function(){return{salarybillId:this.salarybillId,money:this.remitMoney}}},mounted:function(){var n=this;Object(a.a)(location.hash.substring(2)),this.fetchData(this.secrchDate,null,null,this.pageNum,this.pageSize).then(function(t){200==t.data.status&&(n.dataList=t.data.data.list,n.total=t.data.data.cout)})},methods:{fetchData:function(n,t,e,a,i){return function(n,t,e,a,i){var s={username:n,status:t,salaryDate:e,pageNum:a,pageSize:i};return Object(l.a)({url:"/salarybill/admin/salarybill/listSalaryBillsByCondition",method:"get",params:s})}(e,t,n,a,i)},search:function(){var n=this;this.pageNum=1,this.fetchData(this.secrchDate,this.searchStatus,this.searchName,this.pageNum,this.pageSize).then(function(t){200===t.data.status&&(n.dataList=t.data.data.list,n.total=t.data.data.cout)})},handleSelectionChange:function(n){this.multipleSelection=n},leadin:function(){this.leadinDialog=!0},handleChange:function(n,t){this.fileList=t,this.ids=this.handleUpOrDel(t)},handleRemove:function(n,t){this.fileList=t,this.ids=this.handleUpOrDel(t)},handleUpOrDel:function(n){if(n)for(var t=0;t<n.length;t++){console.log(n[t].response);var e=n[t].response;e&&e.code&&(this.ids+=e.record.successResponse[0].id,t<n.length-1&&(this.ids+=","))}return this.ids},numSend:function(){var n=this;if(this.multipleSelection.length<1)this.$message({type:"warning",message:"请选中一行再执行此操作!"});else{for(var t="",e="",a="",l=0;l<this.multipleSelection.length;l++)0==l?(t+=this.multipleSelection[l].id,e+=this.getDate(this.multipleSelection[l].salaryDate),a+=this.multipleSelection[l].enterpriseId):(t+=","+this.multipleSelection[l].id,e+=","+this.getDate(this.multipleSelection[l].salaryDate),a+=","+this.multipleSelection[l].enterpriseId);r(t,e,a,Object(o.a)()).then(function(t){if(200===t.data.status){for(var e=0;e<n.multipleSelection.length;e++)for(var a=0;a<n.dataList.length;a++)n.dataList[a].id==n.multipleSelection[e].id&&(n.dataList[a].status=1);n.$refs.tableList.clearSelection()}})}},send:function(n,t){var e=this;r(t.id,this.getDate(t.salaryDate),t.enterpriseId,Object(o.a)()).then(function(t){200===t.data.status&&(e.dataList[n].status=1,e.$refs.tableList.clearSelection())})},getDate:function(n){return new Date(n).getFullYear()+"-"+(new Date(n).getMonth()+1)},remit:function(n,t){this.currentIndex=n,this.salarybillId=t.id,this.remitDialog=!0},submitTransform:function(){if(this.remitMoney=parseFloat(this.remitMoney),"number"==typeof this.remitMoney){if(isNaN(this.remitMoney))return;if(2==this.dataList[this.currentIndex].status)return this.$refs.uploadTransform.submit(),this.dataList[this.currentIndex].alreadyPay+=100*this.remitMoney,this.dataList[this.currentIndex].status=3,this.salarybillId=0,this.remitMoney=null,this.remitDialog=!1,this.currentIndex=-1,void this.$refs.uploadTransform.clearFiles()}},cancelTransform:function(){this.salarybillId=0,this.remitMoney=null,this.remitDialog=!1,this.currentIndex=-1,this.$refs.uploadTransform.clearFiles()},confirmExcel:function(){var n=this;this.leadinDialog=!1,this.$refs.uploadExcel.clearFiles(),this.searchStatus=null,this.secrchDate="2018-04",this.searchName=null,this.pageNum=1,this.fetchData(this.secrchDate,this.searchStatus,this.searchName,this.pageNum,this.pageSize).then(function(t){200===t.data.status&&(n.dataList=t.data.data.list,n.total=t.data.data.cout)})},removeImg:function(n,t){console.log(n,t)},picPreview:function(n){this.dialogImageUrl=n.url,this.imgDialog=!0},handleCurrentPageChange:function(n){var t=this;this.pageNum=n,this.fetchData(this.secrchDate,this.searchStatus,this.searchName,this.pageNum,this.pageSize).then(function(n){200==n.data.status&&(t.dataList=n.data.data.list,t.total=n.data.data.cout)})},handleClose:function(n){var t=this;this.$confirm("确认关闭？").then(function(n){t.remitDialog=!1,t.salarybillId=0,t.remitMoney=null,t.leadinDialog=!1,t.$refs.uploadTransform.clearFiles(),t.$refs.uploadExcel.clearFiles()}).catch(function(n){})}}},c={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"container"},[e("el-form",[e("el-row",[e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{"label-width":"80px",label:"年月"}},[e("el-date-picker",{attrs:{type:"month","value-format":"yyyy-MM",placeholder:"选择月"},model:{value:n.secrchDate,callback:function(t){n.secrchDate=t},expression:"secrchDate"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:8}},[e("el-form-item",{attrs:{"label-width":"80px",label:"状态"}},[e("el-select",{attrs:{clearable:"",placeholder:"请选择状态"},model:{value:n.searchStatus,callback:function(t){n.searchStatus=t},expression:"searchStatus"}},n._l(n.options,function(n){return e("el-option",{key:n.value,attrs:{label:n.label,value:n.value}})}))],1)],1),n._v(" "),e("el-col",{attrs:{span:9}},[e("el-form-item",{attrs:{"label-width":"80px",label:"员工姓名"}},[e("el-input",{staticStyle:{"max-width":"220px"},attrs:{placeholder:"请输入员工姓名"},model:{value:n.searchName,callback:function(t){n.searchName=t},expression:"searchName"}})],1)],1),n._v(" "),e("el-col",{attrs:{span:6}},[e("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",loading:n.listLoading},on:{click:n.search}},[n._v("查询")])],1)],1),n._v(" "),e("div",{staticClass:"btn_box"},[e("el-button",{staticClass:"el-button--primary",attrs:{code:"leadin"},on:{click:function(t){n.leadin()}}},[n._v("导入")]),n._v(" "),e("el-button",{staticClass:"el-button--primary",attrs:{code:"numSend"},on:{click:n.numSend}},[n._v("批量发送")])],1),n._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:n.listLoading,expression:"listLoading",modifiers:{body:!0}}],ref:"tableList",staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:n.dataList,"element-loading-text":"拼命加载中",border:"",fit:"","tooltip-effect":"dark","highlight-current-row":""},on:{"selection-change":n.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"50"}}),n._v(" "),e("el-table-column",{attrs:{label:"年月",fixed:"left",width:"100"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n            "+n._s(new Date(t.row.salaryDate).getFullYear()+"年"+(new Date(t.row.salaryDate).getMonth()+1)+"月")+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"姓名",fixed:"left"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n            "+n._s(t.row.name)+"\n       ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"入职时间",width:"120"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          "+n._s(new Date(t.row.salaryDate).getFullYear()+"年"+(new Date(t.row.salaryDate).getMonth()+1)+"月"+new Date(t.row.salaryDate).getDate()+"日")+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"应出勤"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          "+n._s(t.row.dutyAttendance)+"天\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"实际出勤"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          "+n._s(t.row.actualAttendance)+"天\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"基础工资",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.baseSalary/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"提成",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.percentage/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"工龄补贴",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.workAgeSubsidy/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"全勤奖",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.totalDayReward/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"交通补贴",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.trafficSubsidy/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"通讯补贴",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.communicationSubsidy/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"出差补助",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.businessTripSubsidy/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"生日福利",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.birthdaySubsidy/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"应发合计",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.shouldPayTotal/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"迟到扣款",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.beLateWithhold/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"养老保险",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.endowmentInsurance/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"医疗保险",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.medicalInsurance/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"失业保险",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.unemploymentInsurance/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"住房公积金",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.housingProvidentFund/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"补差",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.balancePay/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"实发合计",width:"90"},scopedSlots:n._u([{key:"default",fn:function(t){return[n._v("\n          ￥"+n._s(t.row.acturalPayTotal/100)+"\n        ")]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"状态",fixed:"right",width:"140"},scopedSlots:n._u([{key:"default",fn:function(t){return[0==t.row.status?e("p",[n._v("已保存")]):n._e(),n._v(" "),1==t.row.status?e("p",[n._v("待确认")]):n._e(),n._v(" "),2==t.row.status?e("p",[n._v("待打款")]):n._e(),n._v(" "),3==t.row.status?e("p",[n._v("已打款￥"+n._s(t.row.alreadyPay/100))]):n._e()]}}])}),n._v(" "),e("el-table-column",{attrs:{label:"操作",fixed:"right",width:"180"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-button",{staticClass:"el-button--primary",attrs:{code:"send",size:"small"},on:{click:function(e){n.send(t.$index,t.row)}}},[n._v("发送")]),n._v(" "),e("el-button",{staticClass:"el-button--primary",attrs:{code:"remit",size:"small"},on:{click:function(e){n.remit(t.$index,t.row)}}},[n._v("打款")])]}}])})],1),n._v(" "),e("el-pagination",{staticStyle:{float:"right","margin-top":"15px"},attrs:{background:"",layout:"prev, pager, next",total:n.total,"page-size":n.pageSize},on:{"current-change":n.handleCurrentPageChange}}),n._v(" "),e("el-dialog",{attrs:{title:"导入工资",visible:n.leadinDialog,width:"30%","before-close":n.handleCloseExcel},on:{"update:visible":function(t){n.leadinDialog=t}}},[e("el-form-item",{attrs:{label:"导入exe表"}},[e("el-upload",{ref:"uploadExcel",attrs:{action:"http://10.0.0.39/salarybill/admin/salarybill/addSalaryBills?x="+n.token["x-auth-token"],limit:1,"on-change":n.handleChange,"on-remove":n.handleRemove,"file-list":n.fileList}},[e("el-button",{attrs:{size:"small",type:"primary"}},[n._v("上传附件")])],1)],1),n._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:n.confirmExcel}},[n._v("取 消")]),n._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:n.confirmExcel}},[n._v("确 定")])],1)],1),n._v(" "),e("el-dialog",{staticClass:"remitDialog",attrs:{title:"打款明细",visible:n.remitDialog,width:"30%","before-close":n.handleClose},on:{"update:visible":function(t){n.remitDialog=t}}},[e("el-form-item",{attrs:{"label-width":"80px",label:"打款金额"}},[e("el-input",{staticStyle:{"max-width":"220px"},attrs:{placeholder:"输入打款金额"},model:{value:n.remitMoney,callback:function(t){n.remitMoney=t},expression:"remitMoney"}})],1),n._v(" "),e("el-form-item",{attrs:{"label-width":"80px",label:"打款凭据"}},[e("el-upload",{ref:"uploadTransform",attrs:{limit:1,data:n.getTransformData,action:"http://10.0.0.39/salarybill/admin/salarybill/addSalaryTransforms?x='+token['x-auth-token']","list-type":"picture-card","auto-upload":!1,"on-preview":n.picPreview,"on-remove":n.removeImg}},[e("i",{staticClass:"el-icon-plus"})]),n._v(" "),e("el-dialog",{attrs:{visible:n.imgDialog},on:{"update:visible":function(t){n.imgDialog=t}}},[e("img",{attrs:{width:"100%",src:n.dialogImageUrl,alt:""}})])],1),n._v(" "),e("span",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:n.cancelTransform}},[n._v("取 消")]),n._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:n.submitTransform}},[n._v("确 定")])],1)],1)],1)],1)},staticRenderFns:[]};var d=e("VU/8")(u,c,!1,function(n){e("3Kwo")},"data-v-c8747600",null);t.default=d.exports}});