webpackJsonp([20],{oLDE:function(e,n,t){(e.exports=t("FZ+f")(!1)).push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},w19n:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("YY3n"),a=t("dmtY"),o={name:"mainMenu",data:function(){return{treeMenu:null,isDisable:!0,currentId:null,parentId:null,parentMenuId:null,isReadonly:!0,dialogVisible:!1,isBtnShow:!1,editDisabled:!1,editForm:{menuName:"",parentMenu:"",menuAddr:"",menuType:"",menuIcon:"",menuCode:"",menuOrder:""},addForm:{menuName:"",parentMenu:"",menuAddr:"",menuType:"",menuIcon:"",menuCode:"",menuOrder:""},rules:{},addRules:{menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],parentMenu:[{required:!0,message:"请选择父菜单",trigger:"change"}],menuType:[{required:!0,message:"请选择菜单类型",trigger:"change"}],menuIcon:[],menuCode:[],menuOrder:[{required:!0,message:"请输入菜单顺序",trigger:"blur"},{pattern:/^[0-9]*$/,message:"请输入纯数字",trigger:"blur"}]},defaultProps:{children:"children",label:"label"}}},mounted:function(){Object(r.a)(location.hash.substring(2)),this.fetchData()},methods:{fetchData:function(){var e=this;Object(a.g)().then(function(n){e.treeMenu=n.data.data})},getCurrentObj:function(e,n){var t=this;1===e.id?this.editDisabled=!0:this.editDisabled=!1,this.isBtnShow&&this.$confirm("尚未保存修改，要放弃修改吗？",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.isReadonly=!0,t.isBtnShow=!1,t.handleRules()}).catch(function(){}),this.currentId=e.id,this.parentId=n.parent.data.id,this.$refs.editForm.resetFields(),Object(a.c)(this.currentId).then(function(e){t.editForm.menuName=e.data.data.functionName,t.editForm.parentMenu=n.parent.data.label||"无",t.editForm.menuAddr=e.data.data.functionUrl,t.editForm.menuType=e.data.data.functionType,t.editForm.menuIcon=e.data.data.iconStyle,t.editForm.menuOrder=e.data.data.functionSort})},goAddMenu:function(){this.dialogVisible=!0},goEditMenu:function(){this.currentId?(this.isReadonly=!1,this.isBtnShow=!0,this.isDisable=!1,this.handleRules()):this.$message({type:"warning",message:"请在左侧菜单列表中选一行再执行此操作",duration:"2000"})},deleteMenu:function(){var e=this;this.currentId?this.$confirm("此操作将永久删除该菜单，是否继续","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(a.e)(e.currentId).then(function(n){e.$message({type:"success",message:"删除成功",duration:2e3,onClose:function(){e.fetchData()}})})}):this.$message({type:"warning",message:"请在左侧菜单列表中选一行再执行此操作",duration:"2000"})},addSelectParentMenu:function(e){this.parentMenuId=e.id,this.addForm.parentMenu=e.label},editSelectParentMenu:function(e){this.parentMenuId=e.id,this.editForm.parentMenu=e.label},submitForm:function(e){var n=this;this.$refs[e].validate(function(t){if(!t)return console.log("error submit!!"),!1;"addForm"===e?Object(a.a)(n.addForm.menuName,n.parentMenuId,n.addForm.menuAddr,parseInt(n.addForm.menuType),n.addForm.menuIcon,n.addForm.menuCode,n.addForm.menuOrder).then(function(){n.$message({type:"success",message:"添加成功!",duration:1500,onClose:function(){n.fetchData(),n.$refs[e].resetFields(),n.dialogVisible=!1}})}):"editForm"===e&&Object(a.h)(n.currentId,n.editForm.menuName,n.parentMenuId,n.editForm.menuAddr,parseInt(n.editForm.menuType),n.editForm.menuIcon,n.editForm.menuCode,n.editForm.menuOrder).then(function(){n.$message({type:"success",message:"修改成功!",duration:1500,onClose:function(){n.fetchData(),n.$refs[e].resetFields(),n.editDialogVisible=!1,n.isBtnShow=!1,n.isReadonly=!0,n.isDisable=!0}})})})},resetForm:function(e){this.$refs[e].resetFields()},handleClose:function(e){var n=this;this.$confirm("确认关闭吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e(),n.$refs.addForm.resetFields()}).catch(function(){})},addMenuTypeChange:function(e){1===e?(this.addRules.menuCode=[],this.addRules.menuIcon=[{required:!0,message:"请输入菜单图标",trigger:"blur"}]):(this.addRules.menuIcon=[],this.addRules.menuCode=[{required:!0,message:"请输入按钮code",trigger:"blur"}])},editMenuTypeChange:function(e){1===e?(this.rules.menuCode=[],this.rules.menuIcon=[{required:!0,message:"请输入菜单图标",trigger:"blur"}]):(this.rules.menuIcon=[],this.rules.menuCode=[{required:!0,message:"请输入按钮code",trigger:"blur"}])},handleRules:function(){this.isReadonly?this.rules={}:this.rules={menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],parentMenu:[{required:!0,message:"请选择父菜单",trigger:"change"}],menuType:[{required:!0,message:"请选择菜单类型",trigger:"change"}],menuIcon:[],menuCode:[],menuOrder:[{required:!0,message:"请输入菜单顺序",trigger:"blur"},{pattern:/^[0-9]*$/,message:"请输入纯数字",trigger:"blur"}]}}}},i={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"container"},[t("el-row",[t("div",{staticClass:"btn_box",staticStyle:{"margin-bottom":"15px"}},[t("el-button",{staticClass:"el-button--primary",attrs:{size:"small",code:"add"},on:{click:e.goAddMenu}},[e._v("添加菜单")]),e._v(" "),t("el-button",{staticClass:"el-button--primary",attrs:{size:"small",code:"edit",disabled:e.editDisabled},on:{click:e.goEditMenu}},[e._v("修改菜单")]),e._v(" "),t("el-button",{staticClass:"el-button--danger",attrs:{size:"small",code:"del",disabled:e.editDisabled},on:{click:e.deleteMenu}},[e._v("删除菜单")])],1),e._v(" "),t("el-dialog",{attrs:{title:"添加菜单",visible:e.dialogVisible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(n){e.dialogVisible=n}}},[t("el-popover",{ref:"popoverTree",attrs:{placement:"bottom-start",title:"菜单列表",width:"400",trigger:"click"}},[t("el-tree",{ref:"treeAdd",attrs:{data:e.treeMenu,"highlight-current":"",props:e.defaultProps,"expand-on-click-node":!1,"check-strictly":!0},on:{"node-click":e.addSelectParentMenu}})],1),e._v(" "),t("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addRules,"label-width":"85px"}},[t("el-form-item",{attrs:{label:"菜单名",prop:"menuName"}},[t("el-input",{model:{value:e.addForm.menuName,callback:function(n){e.$set(e.addForm,"menuName",n)},expression:"addForm.menuName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"父菜单",prop:"parentMenu"}},[t("el-input",{directives:[{name:"popover",rawName:"v-popover:popoverTree",arg:"popoverTree"}],attrs:{readonly:""},model:{value:e.addForm.parentMenu,callback:function(n){e.$set(e.addForm,"parentMenu",n)},expression:"addForm.parentMenu"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单地址",prop:"menuAddr"}},[t("el-input",{model:{value:e.addForm.menuAddr,callback:function(n){e.$set(e.addForm,"menuAddr",n)},expression:"addForm.menuAddr"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单类型",prop:"menuType"}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:e.addMenuTypeChange},model:{value:e.addForm.menuType,callback:function(n){e.$set(e.addForm,"menuType",n)},expression:"addForm.menuType"}},[t("el-option",{key:1,attrs:{label:"菜单",value:1}}),e._v(" "),t("el-option",{key:2,attrs:{label:"按钮",value:2}})],1)],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.addForm.menuType,expression:"addForm.menuType == 1"}],attrs:{label:"菜单图标",prop:"menuIcon"}},[t("el-input",{model:{value:e.addForm.menuIcon,callback:function(n){e.$set(e.addForm,"menuIcon",n)},expression:"addForm.menuIcon"}})],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.addForm.menuType,expression:"addForm.menuType == 2"}],attrs:{label:"按钮code",prop:"menuCode"}},[t("el-input",{model:{value:e.addForm.menuCode,callback:function(n){e.$set(e.addForm,"menuCode",n)},expression:"addForm.menuCode"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单顺序",prop:"menuOrder"}},[t("el-input",{model:{value:e.addForm.menuOrder,callback:function(n){e.$set(e.addForm,"menuOrder",n)},expression:"addForm.menuOrder"}})],1),e._v(" "),t("el-form-item",{staticClass:"btn_box"},[t("el-button",{attrs:{type:"primary"},on:{click:function(n){e.submitForm("addForm")}}},[e._v("保存")]),e._v(" "),t("el-button",{on:{click:function(n){e.resetForm("addForm")}}},[e._v("重置")])],1)],1)],1),e._v(" "),t("el-col",{attrs:{span:6}},[t("h4",{staticStyle:{"margin-top":"0",color:"#606266"}},[e._v("菜单列表")]),e._v(" "),t("el-tree",{ref:"treeMenu",attrs:{data:e.treeMenu,"node-key":"id","highlight-current":"","default-expand-all":"","expand-on-click-node":!1,props:e.defaultProps},on:{"node-click":e.getCurrentObj}})],1),e._v(" "),t("el-col",{attrs:{span:16}},[t("el-popover",{ref:"popoverTree",attrs:{placement:"bottom-start",title:"菜单列表",width:"400",disabled:e.isDisable,trigger:"click"}},[t("el-tree",{ref:"editAdd",attrs:{data:e.treeMenu,"highlight-current":"",props:e.defaultProps,"expand-on-click-node":!1,"check-strictly":!0},on:{"node-click":e.editSelectParentMenu}})],1),e._v(" "),t("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules,"label-width":"85px"}},[t("el-form-item",{attrs:{label:"菜单名",prop:"menuName"}},[t("el-input",{attrs:{readonly:e.isReadonly},model:{value:e.editForm.menuName,callback:function(n){e.$set(e.editForm,"menuName",n)},expression:"editForm.menuName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"父菜单",prop:"parentMenu"}},[t("el-input",{directives:[{name:"popover",rawName:"v-popover:popoverTree",arg:"popoverTree"}],attrs:{readonly:""},model:{value:e.editForm.parentMenu,callback:function(n){e.$set(e.editForm,"parentMenu",n)},expression:"editForm.parentMenu"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单地址",prop:"menuAddr"}},[t("el-input",{attrs:{readonly:e.isReadonly},model:{value:e.editForm.menuAddr,callback:function(n){e.$set(e.editForm,"menuAddr",n)},expression:"editForm.menuAddr"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单类型",prop:"menuType"}},[t("el-select",{attrs:{disabled:e.isReadonly,placeholder:"请选择"},on:{change:e.editMenuTypeChange},model:{value:e.editForm.menuType,callback:function(n){e.$set(e.editForm,"menuType",n)},expression:"editForm.menuType"}},[t("el-option",{key:1,attrs:{label:"菜单",value:1}}),e._v(" "),t("el-option",{key:2,attrs:{label:"按钮",value:2}})],1)],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.editForm.menuType,expression:"editForm.menuType == 1"}],attrs:{label:"菜单图标",prop:"menuIcon"}},[t("el-input",{attrs:{readonly:e.isReadonly},model:{value:e.editForm.menuIcon,callback:function(n){e.$set(e.editForm,"menuIcon",n)},expression:"editForm.menuIcon"}})],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.editForm.menuType,expression:"editForm.menuType == 2"}],attrs:{label:"按钮code",prop:"menuCode"}},[t("el-input",{attrs:{readonly:e.isReadonly},model:{value:e.editForm.menuCode,callback:function(n){e.$set(e.editForm,"menuCode",n)},expression:"editForm.menuCode"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"菜单顺序",prop:"menuOrder"}},[t("el-input",{attrs:{readonly:e.isReadonly},model:{value:e.editForm.menuOrder,callback:function(n){e.$set(e.editForm,"menuOrder",n)},expression:"editForm.menuOrder"}})],1),e._v(" "),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isBtnShow,expression:"isBtnShow"}],staticClass:"btn_box"},[t("el-button",{attrs:{type:"primary"},on:{click:function(n){e.submitForm("editForm")}}},[e._v("保存")]),e._v(" "),t("el-button",{on:{click:function(n){e.resetForm("editForm")}}},[e._v("重置")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var d=t("VU/8")(o,i,!1,function(e){t("zB5X")},"data-v-0790d76c",null);n.default=d.exports},zB5X:function(e,n,t){var r=t("oLDE");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("rjj0")("31758f95",r,!0)}});